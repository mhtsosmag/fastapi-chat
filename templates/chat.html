<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FastAPI Chat</title>
    <link rel="stylesheet" href="/static/chat.css">
</head>
<body>

<div class="app">
    <!-- CHAT AREA -->
    <div class="chat-area">
        <div class="top-bar">
            <input id="username" placeholder="Username">
            <input id="room" placeholder="Room">
            <button onclick="joinRoom()">Join</button>
            <button onclick="leaveRoom()">Leave</button>
        </div>

        <div id="chat"></div>

        <div class="message-bar">
            <div class="emoji-wrapper">
                <button id="emojiBtn" title="Emojis">ğŸ˜Š</button>
                <div id="emojiPanel" class="emoji-panel">
                    ğŸ˜€ ğŸ˜ ğŸ˜‚ ğŸ¤£ ğŸ˜Š ğŸ˜ ğŸ˜ ğŸ˜˜ ğŸ˜œ ğŸ¤” ğŸ˜¢ ğŸ˜­ ğŸ˜¡ ğŸ‘ ğŸ‘ ğŸ‘ ğŸ™Œ ğŸ‰ â¤ï¸ ğŸ”¥ ğŸš€
                </div>
            </div>

            <input id="message" placeholder="Type a message...">
            <button onclick="sendMessage()">Send</button>
        </div>
    </div>

    <!-- USERS -->
    <div class="users-area">
        <h3>Active Users</h3>
        <div id="active-users"></div>
    </div>
</div>

<script src="/static/chat.js"></script>

<script>
/* Emoji logic */
const emojiBtn = document.getElementById("emojiBtn");
const emojiPanel = document.getElementById("emojiPanel");
const messageInput = document.getElementById("message");

/* Convert emojis to clickable spans */
emojiPanel.innerHTML = emojiPanel.textContent
    .split(" ")
    .map(e => `<span>${e}</span>`)
    .join("");

emojiBtn.onclick = () => {
    emojiPanel.style.display =
        emojiPanel.style.display === "flex" ? "none" : "flex";
};

emojiPanel.addEventListener("click", (e) => {
    if (e.target.tagName === "SPAN") {
        messageInput.value += e.target.textContent;
        messageInput.focus();
    }
});

document.addEventListener("click", (e) => {
    if (!emojiBtn.contains(e.target) && !emojiPanel.contains(e.target)) {
        emojiPanel.style.display = "none";
    }
});
</script>

</body>
</html>
